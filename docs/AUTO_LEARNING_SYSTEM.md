# سیستم یادگیری خودکار
# Auto-Learning System

## 🎯 چیست؟

یک سیستم کامل که به صورت خودکار:
1. ✅ از چت‌های کاربران یاد می‌گیرد
2. ✅ دیتاست را بهبود و بزرگ‌تر می‌کند
3. ✅ نمونه‌های جدید تولید می‌کند
4. ✅ مدل را به صورت دوره‌ای آموزش می‌دهد
5. ✅ کیفیت را به صورت مداوم بهبود می‌دهد

## 🚀 استفاده

### 1. اجرای دستی

```bash
python scripts/smart_learning_system.py
```

### 2. اجرای خودکار (Cron/Scheduled Task)

**Linux/Mac:**
```bash
# هر ساعت یکبار
0 * * * * cd /path/to/TTS_MODEL && python scripts/smart_learning_system.py

# هر 6 ساعت یکبار
0 */6 * * * cd /path/to/TTS_MODEL && python scripts/smart_learning_system.py
```

**Windows (Task Scheduler):**
- ایجاد Task جدید
- Action: `python scripts\smart_learning_system.py`
- Trigger: هر ساعت یا هر 6 ساعت

### 3. اجرای مداوم (Background)

```bash
# Linux
nohup python scripts/smart_learning_system.py > learning.log 2>&1 &

# یا با screen
screen -S auto-learning
python scripts/smart_learning_system.py
# Ctrl+A سپس D برای detach
```

## 🔄 چرخه یادگیری

```
┌─────────────────────────────────┐
│  1. جمع‌آوری چت‌ها از API      │
│     (خودکار در chat_service)   │
└──────────────┬──────────────────┘
               ↓
┌─────────────────────────────────┐
│  2. تحلیل کیفیت چت‌ها           │
│     (فقط نمونه‌های خوب)        │
└──────────────┬──────────────────┘
               ↓
┌─────────────────────────────────┐
│  3. تولید تغییرات هوشمند       │
│     (از الگوهای موجود)         │
└──────────────┬──────────────────┘
               ↓
┌─────────────────────────────────┐
│  4. بهبود دیتاست               │
│     (حذف تکرار، افزودن جدید)   │
└──────────────┬──────────────────┘
               ↓
┌─────────────────────────────────┐
│  5. آموزش مدل                   │
│     (اگر تغییرات قابل توجه)    │
└──────────────┬──────────────────┘
               ↓
┌─────────────────────────────────┐
│  6. تکرار (هر 1 ساعت)          │
└─────────────────────────────────┘
```

## ⚙️ تنظیمات

در `scripts/smart_learning_system.py`:

```python
MIN_CHATS_FOR_LEARNING = 20  # حداقل چت برای آموزش
ENHANCEMENT_INTERVAL = 3600  # هر 1 ساعت (ثانیه)
MAX_DATASET_SIZE = 5000  # حداکثر اندازه دیتاست
```

## 📊 فایل‌ها

- `data/chat_logs.json` - لاگ چت‌های کاربران
- `data/enhancement_log.json` - لاگ بهبودها
- `data/dataset.json` - دیتاست اصلی (بهبود یافته)

## 🔍 تحلیل کیفیت

سیستم به صورت خودکار کیفیت پاسخ‌ها را تحلیل می‌کند:

### معیارهای کیفیت:
- ✅ طول مناسب (50-300 کاراکتر)
- ✅ تکرار کم (کمتر از 25%)
- ✅ کامل بودن (پایان با نقطه)
- ✅ طبیعی بودن (استفاده از عبارات طبیعی)
- ✅ ارتباط با سوال

### فقط نمونه‌های با score >= 5 اضافه می‌شوند

## 📈 رشد دیتاست

### قبل:
- 2003 نمونه

### بعد از چند چرخه:
- 2500+ نمونه (با کیفیت بهتر)
- نمونه‌های متنوع‌تر
- پاسخ‌های کامل‌تر

## 💡 نکات مهم

### 1. لاگ‌های چت
- همه چت‌ها در `data/chat_logs.json` ذخیره می‌شوند
- بعد از آموزش، لاگ‌ها پاک می‌شوند
- حداکثر 1000 چت نگه داشته می‌شود

### 2. بهبود خودکار
- هر 1 ساعت یکبار بررسی می‌شود
- اگر تغییرات قابل توجه باشد، آموزش انجام می‌شود
- دیتاست به صورت خودکار بزرگ‌تر می‌شود

### 3. کیفیت
- فقط نمونه‌های با کیفیت خوب اضافه می‌شوند
- تکرارها به صورت خودکار حذف می‌شوند
- نمونه‌های جدید از الگوهای موجود تولید می‌شوند

## 🎯 نتیجه

با این سیستم:
- ✅ مدل به صورت مداوم بهتر می‌شود
- ✅ دیتاست به صورت خودکار بزرگ‌تر می‌شود
- ✅ کیفیت به صورت مداوم بهبود می‌یابد
- ✅ نیاز به مداخله دستی نیست

## 🔧 عیب‌یابی

### اگر سیستم کار نمی‌کند:

1. بررسی لاگ‌ها:
```bash
cat data/enhancement_log.json
```

2. بررسی چت‌ها:
```bash
cat data/chat_logs.json
```

3. اجرای دستی:
```bash
python scripts/smart_learning_system.py
```

## 📝 مثال خروجی

```
Smart Auto-Learning System
============================================================

Enhancing dataset...

Current dataset size: 2003

1. Learning from chat logs...
   Found 15 good samples from chats

2. Generating smart variations...
   Generated 9 new variations

3. Removing duplicates...
4. Limiting dataset size to 5000...
5. Saving enhanced dataset...

============================================================
Enhancement Summary:
  Original: 2003
  Final: 2027
  Growth: 24 (1.2%)
============================================================

Dataset enhanced! Training model...
```

