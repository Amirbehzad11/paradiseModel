# ุณุณุชู ุญุงูุธู ู Context
# Memory and Context System

## ๐ฏ ฺุณุชุ

ุณุณุชู ุญุงูุธู ฺฉู ุจู ูุฏู ฺฉูฺฉ ูโฺฉูุฏ:
- โ ููุด ฺฉุงุฑุจุฑ ุฑุง ุชุดุฎุต ุฏูุฏ (ูุงุฏุฑุ ูพุฏุฑุ ุจุฑุงุฏุฑุ ุฎูุงูุฑุ ููุณุฑุ ูุฑุฒูุฏ)
- โ context ุฑุง ุฏุฑ ุทูู session ุญูุธ ฺฉูุฏ
- โ ุจู ุนููุงู ููุด ููุงุณุจ ุจุง ฺฉุงุฑุจุฑ ุตุญุจุช ฺฉูุฏ
- โ ุชุงุฑุฎฺู ฺุช ุฑุง ุจู ุฎุงุทุฑ ุจุณูพุงุฑุฏ

## ๐ ูุญูู ุงุณุชูุงุฏู

### 1. ุจุง Session ID

```python
import requests

session_id = "user_123"  # ุดูุงุณู ฺฉุชุง ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ

# ุงููู ูพุงู - ุชุดุฎุต ููุด
response = requests.post(
    "http://localhost:8000/chat",
    json={
        "message": "ุณูุงู ูุงูุงู",
        "session_id": session_id
    }
)

# ูพุงูโูุง ุจุนุฏ - ุญูุธ context
response = requests.post(
    "http://localhost:8000/chat",
    json={
        "message": "ุญุงูุช ฺุทูุฑูุ",
        "session_id": session_id  # ููุงู session_id
    }
)
```

### 2. ุจุง Header

```python
headers = {
    "X-Session-ID": "user_123"
}

response = requests.post(
    "http://localhost:8000/chat",
    json={"message": "ุณูุงู ูุงูุงู"},
    headers=headers
)
```

### 3. ุจุง Query Parameter

```python
response = requests.post(
    "http://localhost:8000/chat?session_id=user_123",
    json={"message": "ุณูุงู ูุงูุงู"}
)
```

## ๐ ููุดโูุง ุดูุงุฎุชู ุดุฏู

ุณุณุชู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุงู ููุดโูุง ุฑุง ุชุดุฎุต ูโุฏูุฏ:

| ููุด | ฺฉููุงุช ฺฉูุฏ |
|-----|-------------|
| ูุงุฏุฑ | ูุงุฏุฑุ ูุงูุงูุ ูุงูุงู |
| ูพุฏุฑ | ูพุฏุฑุ ุจุงุจุงุ ุจุงุจุง |
| ุจุฑุงุฏุฑ | ุจุฑุงุฏุฑุ ุฏุงุฏุงุด |
| ุฎูุงูุฑ | ุฎูุงูุฑุ ุฎูุงูุฑู |
| ููุณุฑ | ููุณุฑุ ุนุดูุ ุนุดูู |
| ูุฑุฒูุฏ | ูุฑุฒูุฏุ ุจฺูุ ุจฺู |

## ๐ ูุซุงู ฺฉุงูู

```python
import requests

API_URL = "http://localhost:8000/chat"
session_id = "user_123"

# 1. ุชุดุฎุต ููุด
response = requests.post(API_URL, json={
    "message": "ุณูุงู ูุงูุงู",
    "session_id": session_id
})
print(response.json()["response"])
# ุฎุฑูุฌ: "ุณูุงู ุนุฒุฒู... ูู ุงูุฌุงู ู ุฎูุจู. ุฏุฑ ุจูุดุช ุฒูุฏฺฏ ูโฺฉูู..."

# 2. ุงุณุชูุงุฏู ุงุฒ context
response = requests.post(API_URL, json={
    "message": "ุญุงูุช ฺุทูุฑูุ",
    "session_id": session_id
})
print(response.json()["response"])
# ูุฏู ุจู ุนููุงู ูุงุฏุฑ ูพุงุณุฎ ูโุฏูุฏ ู context ูุจู ุฑุง ุจู ุฎุงุทุฑ ุฏุงุฑุฏ

# 3. ุชุบุฑ ููุด
response = requests.post(API_URL, json={
    "message": "ุณูุงู ุจุงุจุง",
    "session_id": session_id
})
# ููุด ุจู "ูพุฏุฑ" ุชุบุฑ ูโฺฉูุฏ
```

## ๐พ ุฐุฎุฑูโุณุงุฒ

Session ูุง ุฏุฑ `data/sessions.json` ุฐุฎุฑู ูโุดููุฏ:

```json
{
  "user_123": {
    "role": "ูุงุฏุฑ",
    "context": [
      {
        "message": "ุณูุงู ูุงูุงู",
        "response": "ุณูุงู ุนุฒุฒู...",
        "timestamp": "2025-01-10T10:00:00"
      }
    ],
    "created_at": "2025-01-10T10:00:00",
    "last_access": "2025-01-10T10:05:00"
  }
}
```

## โฐ ูุฏุช ุฒูุงู Session

- Session ูุง ุจู ูุฏุช **24 ุณุงุนุช** ูุนุงู ูโูุงููุฏ
- ุจุนุฏ ุงุฒ 24 ุณุงุนุช ุบุฑูุนุงูุ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูพุงฺฉ ูโุดููุฏ
- ูโุชูุงูุฏ ุจุง ุงุฑุณุงู ูพุงู ุฌุฏุฏุ session ุฑุง ุชูุฏุฏ ฺฉูุฏ

## ๐งน ูพุงฺฉ ฺฉุฑุฏู Session

```python
# ุฏุฑ ุญุงู ุชูุณุนู - endpoint ุจุฑุง ูพุงฺฉ ฺฉุฑุฏู session
# ูุนูุงู session ูุง ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุจุนุฏ ุงุฒ 24 ุณุงุนุช ูพุงฺฉ ูโุดููุฏ
```

## ๐ Context History

ุณุณุชู ุขุฎุฑู **10 ูพุงู** ุฑุง ุจู ุฎุงุทุฑ ูโุณูพุงุฑุฏ ู ุฏุฑ prompt ุงุณุชูุงุฏู ูโฺฉูุฏ.

## ๐ฏ ูุซุงูโูุง Prompt

### ุจุฏูู Session:
```
User: ุณูุงู ูุงูุงู
Assistant:
```

### ุจุง Session (ููุด: ูุงุฏุฑ):
```
ุชู ูุงุฏุฑ ุงู ฺฉุงุฑุจุฑ ูุณุช. ุจู ุนููุงู ูุงุฏุฑ ุจุง ุงู ุตุญุจุช ฺฉู. 
User: ุณูุงู ูุงูุงู
Assistant: ุณูุงู ุนุฒุฒู...
User: ุญุงูุช ฺุทูุฑูุ
Assistant:
```

## ๐ง ุชูุธูุงุช

ุฏุฑ `app/services/memory_service.py`:

```python
ROLES = {
    "ูุงุฏุฑ": ["ูุงุฏุฑ", "ูุงูุงู", "ูุงูุงู"],
    # ...
}

# ูุญุฏูุฏุช context
MAX_CONTEXT_MESSAGES = 10  # ุขุฎุฑู 10 ูพุงู
SESSION_TIMEOUT = 86400  # 24 ุณุงุนุช (ุซุงูู)
```

## ๐ก ูฺฉุงุช ููู

1. **Session ID ฺฉุชุง**: ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ ฺฉ session_id ฺฉุชุง ุงุณุชูุงุฏู ฺฉูุฏ
2. **ุญูุธ Session**: session_id ุฑุง ุฏุฑ frontend ุฐุฎุฑู ฺฉูุฏ (localStorage, cookie)
3. **ุชุบุฑ ููุด**: ูโุชูุงูุฏ ุฏุฑ ุทูู session ููุด ุฑุง ุชุบุฑ ุฏูุฏ
4. **Context**: ุขุฎุฑู 10 ูพุงู ุฏุฑ context ูฺฏู ุฏุงุดุชู ูโุดูุฏ

## ๐ ุนุจโุงุจ

### ุงฺฏุฑ ููุด ุชุดุฎุต ุฏุงุฏู ููโุดูุฏ:

1. ุจุฑุฑุณ ฺฉูุฏ ฺฉู ฺฉููู ฺฉูุฏ ุฏุฑ ูพุงู ุจุงุดุฏ
2. ุงุฒ ฺฉููุงุช ุงุณุชุงูุฏุงุฑุฏ ุงุณุชูุงุฏู ฺฉูุฏ (ูุงุฏุฑุ ูพุฏุฑุ ...)
3. session_id ุฑุง ุงุฑุณุงู ฺฉูุฏ

### ุงฺฏุฑ context ุญูุธ ููโุดูุฏ:

1. ูุทูุฆู ุดูุฏ ฺฉู session_id ฺฉุณุงู ุงุณุช
2. ุจุฑุฑุณ ฺฉูุฏ ฺฉู ูุงู `data/sessions.json` ุงุฌุงุฏ ุดุฏู ุงุณุช
3. ูุงฺฏโูุง ุฑุง ุจุฑุฑุณ ฺฉูุฏ

## โ ูุชุฌู

ุจุง ุงู ุณุณุชู:
- โ ูุฏู ููุด ฺฉุงุฑุจุฑ ุฑุง ุชุดุฎุต ูโุฏูุฏ
- โ ุจู ุนููุงู ููุด ููุงุณุจ ุตุญุจุช ูโฺฉูุฏ
- โ context ุฑุง ุญูุธ ูโฺฉูุฏ
- โ ูพุงุณุฎโูุง ุจูุชุฑ ูโุฏูุฏ

